// =============================================================================
// API Audit: Viper.Crypto.Password - Password Hashing
// =============================================================================
// Tests: Hash, HashIters, Verify
// =============================================================================

module PasswordDemo;
bind Viper.Crypto;
bind Viper.Terminal;

func start() {
    Say("=== API Audit: Viper.Crypto.Password ===");

    // --- Hash ---
    Say("--- Hash ---");
    Say("Hashing 'mypassword'...");
    var hash = Password.Hash("mypassword");
    Say("Hash:");
    Say(hash);

    // --- Verify (correct) ---
    Say("--- Verify (correct) ---");
    Say("Verifying correct password...");
    SayBool(Password.Verify("mypassword", hash));

    // --- Verify (wrong) ---
    Say("--- Verify (wrong) ---");
    Say("Verifying wrong password...");
    SayBool(Password.Verify("wrongpassword", hash));

    // --- HashIters ---
    Say("--- HashIters ---");
    Say("HashIters('test', 1000):");
    var hash2 = Password.HashIters("test", 1000);
    Say(hash2);

    // Verify the iterated hash
    Say("Verify iterated hash:");
    SayBool(Password.Verify("test", hash2));

    Say("=== Password Demo Complete ===");
}
