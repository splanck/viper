module simple_editor;

bind Viper.GUI;
bind Viper.Convert;
bind Viper.Terminal;

// ============================================================================
// SIMPLE EDITOR - Minimal Text Editor Example
// ============================================================================
// A minimal example showing basic Viper.GUI usage.
// ============================================================================

func main() {
    // Create the application window
    var app = GUI.App.New("Simple Editor", 640, 480);

    // Use dark theme
    GUI.Theme.SetDark();

    // Get the root container
    var root = app.Root;

    // Create a vertical layout
    var layout = GUI.VBox.New();
    layout.SetSpacing(8.0);
    layout.SetPadding(8.0);
    root.AddChild(layout);

    // Add a title label
    var title = GUI.Label.New(layout, "Simple Text Editor");
    title.SetColor(0xFFFFFFFF);

    // Add a text input for the filename
    var filenameLabel = GUI.Label.New(layout, "Filename:");
    filenameLabel.SetColor(0xFFAAAAAA);

    var filename = GUI.TextInput.New(layout);
    filename.SetPlaceholder("Enter filename...");
    filename.SetSize(300, 28);

    // Add the code editor
    var editor = GUI.CodeEditor.New(layout);
    editor.SetSize(620, 350);
    editor.SetText("// Type your code here\n\nfunc hello() {\n    Terminal.Say(\"Hello!\");\n}\n");

    // Add a button bar
    var buttons = GUI.HBox.New();
    buttons.SetSpacing(8.0);
    layout.AddChild(buttons);

    var clearBtn = GUI.Button.New(buttons, "Clear");
    clearBtn.SetSize(80, 32);

    var saveBtn = GUI.Button.New(buttons, "Save");
    saveBtn.SetSize(80, 32);
    saveBtn.SetStyle(1);  // Primary

    // Status label
    var status = GUI.Label.New(layout, "Ready");
    status.SetColor(0xFF888888);

    // Main loop
    while app.ShouldClose == false {
        app.Poll();

        // Handle clear button
        if clearBtn.WasClicked() != 0 {
            editor.SetText("");
            status.SetText("Editor cleared");
        }

        // Handle save button
        if saveBtn.WasClicked() != 0 {
            status.SetText("Saved!");
            editor.ClearModified();
        }

        // Update status with line count
        if editor.IsModified() != 0 {
            var lineStr = Convert.ToString_Int(editor.LineCount);
            status.SetText("Modified - " + lineStr + " lines");
        }

        app.Render();
    }

    app.Destroy();
}
