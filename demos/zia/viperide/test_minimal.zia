module test_minimal;

bind GUI = Viper.GUI;
bind Terminal = Viper.Terminal;

entity Shell {
    expose GUI.App app;
    expose GUI.VBox mainVBox;
    expose GUI.MenuBar menuBar;
    expose GUI.Menu fileMenu;

    expose func Build() {
        app = GUI.App.New("Minimal", 800, 600);
        GUI.Theme.SetDark();

        mainVBox = GUI.VBox.New();
        mainVBox.SetSpacing(0.0);
        mainVBox.SetPadding(0.0);
        var root: GUI.Widget = app.Root;
        root.AddChild(mainVBox);

        menuBar = GUI.MenuBar.New(mainVBox);
        fileMenu = menuBar.AddMenu("File");
        var mi: GUI.MenuItem = fileMenu.AddItem("Quit");

        Terminal.Say("Build done, entering loop");
    }
}

func main() {
    var s = new Shell();
    s.Build();

    while s.app.ShouldClose == 0 {
        s.app.Poll();
        s.app.Render();
    }
    s.app.Destroy();
}
