// Bug #7 Test: Dir.List returns proper List[String] type
// This tests that Dir.List returns a typed list that supports .count() and .get()
// Previously this returned a raw ptr, breaking method calls
module main;

bind Viper.Terminal;
bind Viper.IO;

func main() {
    Say("Testing Bug #7: Dir.List typed return value");
    Say("=============================================");
    Say("");

    // Use a known path instead of current directory (which may be empty in runtime)
    var testDir = "/tmp";
    Print("Test directory: ");
    Say(testDir);
    Say("");

    // List directory contents
    var entries = Dir.List(testDir);

    // Test .count() method - this was broken before the fix
    var count = entries.count();
    Print("Number of entries: ");
    PrintInt(count);
    Say("");
    Say("");

    // List first few entries using .get()
    Say("First 5 entries (or all if fewer):");
    var i = 0;
    var limit = 5;
    if count < limit {
        limit = count;
    }
    while i < limit {
        String entry = entries.get(i);
        Print("  ");
        PrintInt(i);
        Print(": ");
        Say(entry);
        i = i + 1;
    }

    Say("");

    // Verify we got entries
    if count > 0 {
        Say("SUCCESS: Dir.List returned entries with working .count() and .get()");
    } else {
        Say("WARNING: Directory appears empty (may still be working correctly)");
    }

    Say("");
    Say("Bug #7 Test PASSED!");
}
