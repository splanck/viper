# File: tests/basic/lex/check_tokens.cmake
# Purpose: Compare BASIC lexer output to golden tokens.

if (NOT DEFINED BASIC_LEX_DUMP)
    message(FATAL_ERROR "BASIC_LEX_DUMP not set")
endif ()
if (NOT DEFINED BAS_FILE)
    message(FATAL_ERROR "BAS_FILE not set")
endif ()
if (NOT DEFINED GOLDEN)
    message(FATAL_ERROR "GOLDEN not set")
endif ()
execute_process(COMMAND ${BASIC_LEX_DUMP} ${BAS_FILE} OUTPUT_VARIABLE out RESULT_VARIABLE res)
if (NOT res EQUAL 0)
    message(FATAL_ERROR "dump failed")
endif ()
file(READ ${GOLDEN} expected)
if (NOT out STREQUAL expected)
    message(FATAL_ERROR "Token mismatch\nExpected: ${expected}\nGot: ${out}")
endif ()
