module TestCrypto;
bind Viper.Crypto.Hash;
bind Viper.Crypto.Rand;
bind Viper.Crypto.Password;
bind Viper.Terminal;

func start() {
    Say(MD5("hello"));
    Say(SHA1("hello"));
    Say(SHA256("hello"));
    SayInt(CRC32("hello"));
    Say(HmacMD5("hello", "key"));
    Say(HmacSHA1("hello", "key"));
    Say(HmacSHA256("hello", "key"));

    var r1 = Viper.Crypto.Rand.Int(1, 100);
    SayBool(r1 > 0);
    SayBool(r1 < 101);

    var rb = Bytes(16);
    SayInt(rb.Len);

    var pw = Hash("secret");
    SayBool(Viper.String.Has(pw, "$"));
    SayBool(Verify("secret", pw));
    SayBool(Verify("wrong", pw));

    Say("done");
}
