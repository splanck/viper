module TestEntityNested;

// Test: Nested entities

entity Point {
    expose Integer x;
    expose Integer y;

    expose func init(px: Integer, py: Integer) {
        x = px;
        y = py;
    }

    expose func getSum() -> Integer {
        return x + y;
    }
}

entity Container {
    expose Point point;
    expose Integer value;

    expose func init(px: Integer, py: Integer, v: Integer) {
        point = new Point(px, py);
        value = v;
    }
}

func start() {
    Viper.Terminal.Say("=== Nested Entity Test ===");

    var c: Container = new Container(5, 10, 42);
    Viper.Terminal.Say("point.x = " + Viper.Strings.FromInt(c.point.x));
    Viper.Terminal.Say("point.y = " + Viper.Strings.FromInt(c.point.y));
    Viper.Terminal.Say("value = " + Viper.Strings.FromInt(c.value));
    Viper.Terminal.Say("point.getSum() = " + Viper.Strings.FromInt(c.point.getSum()));

    if (c.point.x == 5 && c.point.y == 10 && c.value == 42 && c.point.getSum() == 15) {
        Viper.Terminal.Say("RESULT: ok");
    } else {
        Viper.Terminal.Say("RESULT: fail");
    }
}
