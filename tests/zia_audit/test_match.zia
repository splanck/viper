module TestMatch;

// Test: Match statements

var passed: Integer = 0;
var failed: Integer = 0;

func check(name: String, actual: Integer, expected: Integer) {
    if (actual == expected) {
        passed = passed + 1;
    } else {
        failed = failed + 1;
        Viper.Terminal.Say("FAIL: " + name + " - expected " + Viper.Strings.FromInt(expected) + ", got " + Viper.Strings.FromInt(actual));
    }
}

func start() {
    Viper.Terminal.Say("=== Match Statement Tests ===");

    // Match with literals
    var x: Integer = 2;
    var result: Integer = 0;
    match x {
        0 => { result = 10; }
        1 => { result = 20; }
        2 => { result = 30; }
        _ => { result = 99; }
    }
    check("Match literal", result, 30);

    // Match with wildcard
    x = 100;
    match x {
        0 => { result = 10; }
        1 => { result = 20; }
        _ => { result = 99; }
    }
    check("Match wildcard", result, 99);

    // Match with binding
    x = 42;
    match x {
        0 => { result = 0; }
        n => { result = n + 1; }
    }
    check("Match binding", result, 43);

    // Report results
    Viper.Terminal.Say("=== Results ===");
    Viper.Terminal.Say("Passed: " + Viper.Strings.FromInt(passed));
    Viper.Terminal.Say("Failed: " + Viper.Strings.FromInt(failed));

    if (failed == 0) {
        Viper.Terminal.Say("RESULT: ok");
    } else {
        Viper.Terminal.Say("RESULT: fail");
    }
}
