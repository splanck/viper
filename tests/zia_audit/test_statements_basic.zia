module TestStatementsBasic;

// Test: Basic control flow statements (isolated)

var passed: Integer = 0;
var failed: Integer = 0;

func check(name: String, actual: Integer, expected: Integer) {
    if (actual == expected) {
        passed = passed + 1;
    } else {
        failed = failed + 1;
        Viper.Terminal.Say("FAIL: " + name + " - expected " + Viper.Strings.FromInt(expected) + ", got " + Viper.Strings.FromInt(actual));
    }
}

func start() {
    Viper.Terminal.Say("=== Basic Statement Tests ===");

    // Simple if
    var x: Integer = 0;
    if (true) {
        x = 1;
    }
    check("If true branch", x, 1);

    x = 0;
    if (false) {
        x = 1;
    }
    check("If false no branch", x, 0);

    // If-else
    x = 0;
    if (true) {
        x = 1;
    } else {
        x = 2;
    }
    check("If-else true", x, 1);

    x = 0;
    if (false) {
        x = 1;
    } else {
        x = 2;
    }
    check("If-else false", x, 2);

    // Basic while
    var count: Integer = 0;
    var i: Integer = 0;
    while (i < 5) {
        count = count + 1;
        i = i + 1;
    }
    check("While loop count", count, 5);

    // Basic for
    var sum: Integer = 0;
    for (var j: Integer = 0; j < 5; j = j + 1) {
        sum = sum + j;
    }
    check("For loop sum", sum, 10);

    // For-in range
    sum = 0;
    for k in 0..5 {
        sum = sum + k;
    }
    check("For-in range 0..5", sum, 10);

    // Break
    count = 0;
    for (var l: Integer = 0; l < 100; l = l + 1) {
        if (l == 5) {
            break;
        }
        count = count + 1;
    }
    check("Break at 5", count, 5);

    // Continue
    count = 0;
    for (var m: Integer = 0; m < 10; m = m + 1) {
        if (m % 2 == 0) {
            continue;
        }
        count = count + 1;
    }
    check("Continue evens", count, 5);

    // Report results
    Viper.Terminal.Say("=== Results ===");
    Viper.Terminal.Say("Passed: " + Viper.Strings.FromInt(passed));
    Viper.Terminal.Say("Failed: " + Viper.Strings.FromInt(failed));

    if (failed == 0) {
        Viper.Terminal.Say("RESULT: ok");
    } else {
        Viper.Terminal.Say("RESULT: fail");
    }
}
